---
import Layout from '../../layouts/Layout.astro';
import CutCard from '../../components/CutCard';
import { getCutsByPrimal } from '../../data/cuts';
import { primalCuts, getPrimalBySlug } from '../../data/primalCuts';
import type { PrimalCutInfo } from '../../data/primalCuts';

export function getStaticPaths() {
  return primalCuts.map((primal) => ({
    params: { primal: primal.slug },
    props: { primal },
  }));
}

interface Props {
  primal: PrimalCutInfo;
}

const { primal } = Astro.props;
const cuts = getCutsByPrimal(primal.name);

// Sort cuts by popularity/importance
const sortedCuts = [...cuts].sort((a, b) => {
  // Prioritize prime cuts and Tokusen available
  const aScore = (a.isPrimeCut ? 2 : 0) + (a.isTokusenAvailable ? 1 : 0);
  const bScore = (b.isPrimeCut ? 2 : 0) + (b.isTokusenAvailable ? 1 : 0);
  return bScore - aScore;
});
---

<Layout
  title={`${primal.name} Cuts`}
  description={`Explore all beef cuts from the ${primal.name} primal region. ${primal.description}`}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Breadcrumb -->
    <nav class="mb-6 text-sm">
      <ol class="flex items-center gap-2 text-gray-500">
        <li><a href="/" class="hover:text-gray-900">Home</a></li>
        <li>/</li>
        <li><a href="/cuts" class="hover:text-gray-900">Cuts</a></li>
        <li>/</li>
        <li class="text-gray-900 font-medium">{primal.name}</li>
      </ol>
    </nav>

    <!-- Header -->
    <header class="mb-12">
      <div class="flex items-center gap-4 mb-4">
        <span class="text-5xl">{primal.icon || 'ðŸ¥©'}</span>
        <div>
          <h1 class="text-4xl font-bold text-gray-900">{primal.name}</h1>
          <p class="text-gray-500">{cuts.length} cuts from this region</p>
        </div>
      </div>
      <p class="text-xl text-gray-600 max-w-3xl">{primal.description}</p>
    </header>

    <!-- Primal Info Grid -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
      <!-- Location -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6">
        <h3 class="font-semibold text-gray-900 mb-2">Location on Cow</h3>
        <p class="text-gray-600">{primal.location}</p>
      </div>

      <!-- Characteristics -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6">
        <h3 class="font-semibold text-gray-900 mb-2">Characteristics</h3>
        <ul class="text-gray-600 space-y-1">
          {primal.characteristics.slice(0, 3).map((char) => (
            <li class="flex items-start gap-2">
              <span class="text-red-500 mt-1">â€¢</span>
              {char}
            </li>
          ))}
        </ul>
      </div>

      <!-- Typical Cooking -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6">
        <h3 class="font-semibold text-gray-900 mb-2">Best Cooking Methods</h3>
        <div class="flex flex-wrap gap-2">
          {primal.commonCookingMethods.slice(0, 4).map((method) => (
            <span class="px-2 py-1 bg-gray-100 text-gray-700 text-sm rounded">
              {method}
            </span>
          ))}
        </div>
      </div>
    </div>

    <!-- Additional Characteristics -->
    {primal.characteristics.length > 3 && (
      <div class="bg-gray-50 rounded-lg p-6 mb-12">
        <h3 class="font-semibold text-gray-900 mb-4">More About {primal.name}</h3>
        <ul class="grid grid-cols-1 md:grid-cols-2 gap-3 text-gray-600">
          {primal.characteristics.slice(3).map((char) => (
            <li class="flex items-start gap-2">
              <span class="text-red-500 mt-1">â€¢</span>
              {char}
            </li>
          ))}
        </ul>
      </div>
    )}

    <!-- Cuts Grid -->
    <section>
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold text-gray-900">
          Cuts from {primal.name}
        </h2>
        <a
          href="/cuts"
          class="text-red-600 hover:text-red-800 font-medium text-sm"
        >
          View all cuts â†’
        </a>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {sortedCuts.map((cut) => (
          <a href={`/cuts/${cut.id}`}>
            <CutCard cut={cut} showPrimal={false} client:load />
          </a>
        ))}
      </div>
    </section>

    <!-- Other Primals -->
    <section class="mt-16">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Explore Other Primals</h2>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        {primalCuts
          .filter((p) => p.slug !== primal.slug)
          .slice(0, 4)
          .map((p) => (
            <a
              href={`/primal/${p.slug}`}
              class="bg-white rounded-lg p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow text-center"
            >
              <span class="text-3xl">{p.icon || 'ðŸ¥©'}</span>
              <h3 class="font-medium text-gray-900 mt-2">{p.name}</h3>
              <p class="text-sm text-gray-500">{getCutsByPrimal(p.name).length} cuts</p>
            </a>
          ))}
      </div>
    </section>
  </div>
</Layout>
